<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Upload a File to DataStore • NPSdatastore</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Upload a File to DataStore">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NPSdatastore</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/upload-file.html">Upload a File to DataStore</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Upload a File to DataStore</h1>
            
      

      <div class="d-none name"><code>upload-file.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nationalparkservice.github.io/NPSdatastore/">NPSdatastore</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="before-you-start">Before you start<a class="anchor" aria-label="anchor" href="#before-you-start"></a>
</h2>
<p>Before attempting to upload a file to a DataStore reference, there
are some conditions that need to be met.</p>
<ol style="list-style-type: decimal">
<li>Make sure you have edit permissions to the DataStore reference.</li>
<li>Make sure the reference permits uploads. Certain types of reference,
such as programs and projects, are designed to be containers for
organizing other references and therefore cannot directly contain
files.</li>
<li>Make sure you are on the internal NPS network.</li>
</ol>
</div>
<div class="section level2">
<h2 id="testing">Testing<a class="anchor" aria-label="anchor" href="#testing"></a>
</h2>
<p>Consider using the testing version of DataStore [<a href="https://irmadev.nps.gov/DataStore" class="external-link uri">https://irmadev.nps.gov/DataStore</a>] to make sure your
code works as expected before uploading to the real DataStore. This is
an especially good idea if you are iterating through a large number of
files.</p>
</div>
<div class="section level2">
<h2 id="uploading-the-file">Uploading the file<a class="anchor" aria-label="anchor" href="#uploading-the-file"></a>
</h2>
<p>You’ll need the following information:</p>
<ul>
<li>The location of the file on your hard drive. Make sure that the path
includes the name of the file (not just the folder it lives in), and be
sure that the slashes in the path are either single forward slashes (/)
or double backslashes (\).</li>
<li>The reference ID of the DataStore reference you are uploading to.
When you navigate to your reference in a web browser, the URL will look
something like this: “<a href="https://irma.nps.gov/DataStore/Reference/Profile/1234567" class="external-link uri">https://irma.nps.gov/DataStore/Reference/Profile/1234567</a>”.
The number at the end of the URL (in this example, 1234567) is your
reference ID.</li>
<li>Whether the file is 508-compliant.</li>
</ul>
<p>Set that information using the code template below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file_to_upload</span> <span class="op">&lt;-</span> <span class="st">"C:/your/file/location/here.csv"</span></span>
<span><span class="va">reference_id</span> <span class="op">&lt;-</span> <span class="fl">1234567</span>  <span class="co"># Replace this with your reference ID</span></span>
<span><span class="va">dev</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Change this to FALSE when you are done testing</span></span>
<span><span class="va">is_508_compliant</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>  <span class="co"># If you know your file is 508 compliant, change to TRUE</span></span>
<span><span class="va">interactive</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># If TRUE, you will be prompted to confirm file upload</span></span></code></pre></div>
<p>Double-check your reference ID! If it’s incorrect, your file upload
will either fail, or the file could end up in the wrong reference.</p>
<p>Double-check your file path! Make sure it’s correct, and make sure
you aren’t uploading sensitive data to a public reference.</p>
<p>Once you are certain everything is correct, perform the file
upload:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uploaded_file_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/upload_file_to_reference.html">upload_file_to_reference</a></span><span class="op">(</span>reference_id <span class="op">=</span> <span class="va">reference_id</span>,</span>
<span>                                               file_path <span class="op">=</span> <span class="va">file_to_upload</span>, </span>
<span>                                               is_508 <span class="op">=</span> <span class="va">is_508_compliant</span>,</span>
<span>                                               interactive <span class="op">=</span> <span class="va">interactive</span>,</span>
<span>                                               dev <span class="op">=</span> <span class="va">dev</span><span class="op">)</span></span></code></pre></div>
<p><code>upload_file_to_reference</code> will return a list containing a
direct download URL for your file, as well as the file ID that DataStore
uses to uniquely identify your file.</p>
</div>
<div class="section level2">
<h2 id="uploading-multiple-files-at-once">Uploading multiple files at once<a class="anchor" aria-label="anchor" href="#uploading-multiple-files-at-once"></a>
</h2>
<p>If you need to upload many files to the same reference, you just need
to generate a vector of file paths that you can iterate over.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_folder</span> <span class="op">&lt;-</span> <span class="st">"scratchpad"</span>  <span class="co"># The folder containing the files you want to upload</span></span>
<span><span class="va">pattern</span> <span class="op">&lt;-</span> <span class="st">"\\.csv$"</span>  <span class="co"># Look for files ending in ".csv"</span></span>
<span><span class="va">my_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">my_folder</span>, pattern <span class="op">=</span> <span class="va">pattern</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Next, use <code>lapply</code> to upload each file:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interactive</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>  <span class="co"># Turn off the interactive confirmation prompt</span></span>
<span><span class="va">dev</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># It's definitely good to test this out on irmadev first</span></span>
<span><span class="va">reference_id</span> <span class="op">&lt;-</span> <span class="fl">1234567</span>  <span class="co"># Replace this with your reference ID</span></span>
<span></span>
<span><span class="co"># Iterate through each file and upload it</span></span>
<span><span class="va">all_file_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">my_files</span>, <span class="kw">function</span><span class="op">(</span><span class="va">file</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">file_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/upload_file_to_reference.html">upload_file_to_reference</a></span><span class="op">(</span>reference_id <span class="op">=</span> <span class="va">reference_id</span>,</span>
<span>                                        file_path <span class="op">=</span> <span class="va">file</span>, </span>
<span>                                        is_508 <span class="op">=</span> <span class="va">is_508_compliant</span>,</span>
<span>                                        interactive <span class="op">=</span> <span class="va">interactive</span>,</span>
<span>                                        dev <span class="op">=</span> <span class="va">dev</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>original_file <span class="op">=</span> <span class="va">file</span>,</span>
<span>                        url <span class="op">=</span> <span class="va">file_info</span><span class="op">$</span><span class="va">url</span>,</span>
<span>                        file_id <span class="op">=</span> <span class="va">file_info</span><span class="op">$</span><span class="va">file_id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Collapse uploaded file info into a single dataframe</span></span>
<span><span class="va">all_file_info</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">all_file_info</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sarah E. Wright.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
